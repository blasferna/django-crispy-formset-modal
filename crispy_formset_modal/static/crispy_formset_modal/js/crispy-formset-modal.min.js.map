{"version":3,"file":"crispy-formset-modal.min.js","sources":["../../../../js/src/utils.js","../../../../js/src/formset.js","../../../../js/src/modal.js","../../../../js/src/modal-form.js","../../../../js/src/formset-modal.js","../../../../js/src/index.js"],"sourcesContent":["let gettext = window.gettext;\nconst _has = Object.prototype.hasOwnProperty;\n/**\n * Checks if the object has the property passed as argument\n */\nexport function has(object, key) {\n  return _has.call(object, key);\n}\n\nexport function uuidv4() {\n  function randomHex() {\n    return Math.floor((1 + Math.random()) * 0x10000)\n      .toString(16)\n      .substring(1);\n  }\n\n  const part1 = randomHex() + randomHex();\n  const part2 = randomHex();\n  const part3 = ((parseInt(randomHex(), 16) & 0x0fff) | 0x4000).toString(16);\n  const part4 = ((parseInt(randomHex(), 16) & 0x3fff) | 0x8000).toString(16);\n  const part5 = randomHex() + randomHex() + randomHex();\n\n  return `${part1}-${part2}-${part3}-${part4}-${part5}`;\n}\n\nexport function getTextValue(el) {\n  let type = el.tagName.toLowerCase();\n  let textValue = \"\";\n  if (type === \"select\") {\n    let tempDiv = document.createElement(\"div\");\n    if (el.options[el.selectedIndex]) {\n    tempDiv.innerHTML = el.options[el.selectedIndex].innerText;\n    } else {\n        tempDiv.innerHTML = \"-------\";\n    }\n    textValue = tempDiv.innerText\n      .split(\"\\n\")\n      .map((item) => item.trim())\n      .join(\" \")\n      .trim();\n  } else {\n    if (has(el, \"inputmask\")) {\n      textValue = el.inputmask.undoValue;\n    } else {\n      if (el.getAttribute(\"type\") == \"date\") {\n        if (el.value) {\n          textValue = el.value;\n        }\n      } else {\n        if (el.getAttribute(\"type\") == \"checkbox\") {\n          textValue = el.checked ? \"on\" : \"off\";\n        } else {\n          textValue = el.value;\n        }\n      }\n    }\n  }\n  return textValue;\n}\n\nexport function getNumberValue(value) {\n  return Number(value);\n}\n\nexport function executeAllCalculatedFields() {\n  if (window.hasOwnProperty(\"calculatedFields\")) {\n    calculatedFields.forEach(function (obj) {\n      obj.executeAll();\n    });\n  }\n}\n\nexport function hookCalculatedFields() {\n  if (window.hasOwnProperty(\"calculatedFields\")) {\n    window.calculatedFields.forEach(function (obj) {\n      let el = obj.field;\n      let id = el.getAttribute(\"id\");\n      let column = document.querySelector(\"td[data-source='\" + id + \"']\");\n      if (column) {\n        if (!el.hasAttribute(\"data-event\")) {\n          el.addEventListener(\"oncalculate\", function () {\n            let content = getTextValue(el);\n            // The column element is refetched since the table is recreated on each event\n            let _column = document.querySelector(\n              \"td[data-source='\" + id + \"']\"\n            );\n            if (_column) {\n              _column.innerText = content;\n            }\n          });\n          el.setAttribute(\"data-event\", true);\n        }\n      }\n    });\n  }\n}\n\nexport function removeChildren(a) {\n  while (a.hasChildNodes()) {\n    a.removeChild(a.lastChild);\n  }\n}\n\nexport function injectStyles() {\n  const styleId = \"cfm-styles\";\n  if (!document.getElementById(styleId)) {\n    const css = `\n      .cfm-selection-border {\n          position: absolute;\n          top: 0px;\n          bottom: 0px;\n          left: 0px;\n          width: 0.150rem;\n          background-color: rgb(220 53 69 / 1);\n      }\n      .cfm-modal-backdrop {\n          position: fixed;\n          inset: 0px;\n          z-index: 1050;\n          background-color: rgb(31 41 55 / 1);\n          opacity: 0;\n          transition-property: opacity;\n          transition-duration: 300ms;\n          transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n      }\n      .cfm-opacity-50 {\n          opacity: 0.5;\n      }\n      .cfm-opacity-100 {\n          opacity: 1;\n      }\n      .cfm-tr.selected{\n        background-color: rgba(0, 0, 0, 0.08) !important;\n      }\n      .cfm .modal-body {\n        max-height: calc(100vh - 150px);\n        overflow-x: auto;\n      }\n      .cfm-cursor-pointer {\n        cursor: pointer;\n      }\n      [data-formset-form] .modal {\n        z-index: 1051;\n      }\n      `;\n    const style = document.createElement(\"style\");\n    style.innerHTML = css;\n    style.id = styleId;\n    document.head.appendChild(style);\n  }\n}\n\nexport function getModalInstance(id, instances) {\n  if (instances.some((modalInstance) => modalInstance.id === id)) {\n    return instances.find((modalInstance) => modalInstance.id === id);\n  }\n  return false;\n}\n\nexport function ready(fn) {\n  if (document.readyState !== \"loading\") {\n    fn();\n  } else {\n    document.addEventListener(\"DOMContentLoaded\", fn);\n  }\n}\n\nif (!window.django || !window.django.jsi18n_initialized) {\n  gettext = (msg) => msg;\n}\n\nconst bootstrap4Classes = {\n  hidden: \"d-none\",\n  inlineFlex: \"d-inline-flex\",\n  flex: \"d-flex\",\n  relative: \"position-relative\",\n  textRight: \"text-right\",\n  textCenter: \"text-center\",\n  alignMiddle: \"align-middle\",\n  pointer: \"cfm-cursor-pointer\",\n  checkbox: \"checkbox\",\n  td: \"cfm-td\",\n  tr: \"cfm-tr\",\n  selectionMark: \"cfm-selection-border\",\n  p0: \"p-0\",\n  opacity50: \"cfm-opacity-50\",\n  opacity100: \"cfm-opacity-100\",\n  backdrop: \"cfm-modal-backdrop\",\n  justifyStart: \"justify-content-start\",\n  justifyCenter: \"justify-content-center\",\n  justifyEnd: \"justify-content-end\",\n  itemsStart: \"align-items-start\",\n  itemsCenter: \"align-items-center\",\n  itemsEnd: \"align-items-end\",\n};\n\nconst bootstrap5Classes = {\n  ...bootstrap4Classes,\n  textRight: \"text-end\",\n  checkbox: \"checkbox form-check-input\",\n};\n\nconst tailwindClasses = {\n  hidden: \"hidden\",\n  inlineFlex: \"inline-flex\",\n  flex: \"flex\",\n  relative: \"relative\",\n  textRight: \"text-right\",\n  textCenter: \"text-center\",\n  alignMiddle: \"align-middle\",\n  pointer: \"cursor-pointer\",\n  checkbox:\n    \"w-4 rounded border-gray-300 focus:ring-indigo-500 text-indigo-600 h-4\",\n  td: \"whitespace-nowrap px-3 py-3 text-sm text-gray-500\",\n  tr: \"divide-x divide-gray-200 border-b\",\n  selectionMark:\n    \"absolute inset-y-0 left-0 w-0.5 bg-indigo-600 selection-border\",\n  p0: \"p-0\",\n  opacity50: \"opacity-50\",\n  opacity100: \"opacity-100\",\n  backdrop:\n    \"transition-opacity ease-in-out duration-300 opacity-0 bg-gray-800 fixed inset-0 z-40\",\n  justifyStart: \"justify-start\",\n  justifyCenter: \"justify-center\",\n  justifyEnd: \"justify-end\",\n  itemsStart: \"items-start\",\n  itemsCenter: \"items-center\",\n  itemsEnd: \"items-end\",\n};\n\nconst bulmaClasses = {\n  hidden: \"is-hidden\",\n  inlineFlex: \"is-inline-flex\",\n  flex: \"is-flex\",\n  relative: \"is-relative\",\n  textRight: \"has-text-right\",\n  textCenter: \"has-text-center\",\n  alignMiddle: \"is-vcentered\",\n  pointer: \"cfm-cursor-pointer\",\n  checkbox: \"checkbox\",\n  td: \"cfm-td\",\n  tr: \"cfm-tr\",\n  selectionMark: \"cfm-selection-border\",\n  p0: \"p-0\",\n  opacity50: \"cfm-opacity-50\",\n  opacity100: \"cfm-opacity-100\",\n  backdrop: \"cfm-modal-backdrop\",\n  justifyStart: \"is-justify-content-start\",\n  justifyCenter: \"is-justify-content-center\",\n  justifyEnd: \"is-justify-content-end\",\n  itemsStart: \"is-align-items-start\",\n  itemsCenter: \"is-align-items-center\",\n  itemsEnd: \"is-align-items-end\",\n};\n\nconst tailwindSizeClasses = {\n  sm: \"max-w-lg\",\n  md: \"max-w-4xl\",\n  lg: \"max-w-5xl\",\n  xl: \"max-w-6xl\",\n};\n\nconst bootstrap4SizeClasses = {\n  sm: \"modal-sm\",\n  md: \"modal-md\",\n  lg: \"modal-lg\",\n  xl: \"modal-xl\",\n};\n\nconst bootstrap5SizeClasses = bootstrap4SizeClasses;\n\nconst bulmaSizeClasses = {\n  sm: \"modal-sm\",\n  md: \"modal-md\",\n  lg: \"modal-lg\",\n  xl: \"modal-xl\",\n};\n\nconst templatePacks = {\n  bootstrap4: {\n    classes: bootstrap4Classes,\n    sizes: bootstrap4SizeClasses,\n  },\n  bootstrap5: {\n    classes: bootstrap5Classes,\n    sizes: bootstrap5SizeClasses,\n  },\n  tailwind: {\n    classes: tailwindClasses,\n    sizes: tailwindSizeClasses,\n  },\n  bulma: {\n    classes: bulmaClasses,\n    sizes: bulmaSizeClasses,\n  },\n};\n\nexport { gettext, bootstrap4Classes, templatePacks };\n","/**\n* Django formset helper\n* Copyright (c) 2013, Ionata Web Solutions\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without\n* modification, are permitted provided that the following conditions are met:\n*\n* Redistributions of source code must retain the above copyright notice, this\n* list of conditions and the following disclaimer.\n*\n* Redistributions in binary form must reproduce the above copyright notice, this\n* list of conditions and the following disclaimer in the documentation and/or\n* other materials provided with the distribution.\n*\n* THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n* ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n* WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n* DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE\n* FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL\n* DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR\n* SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER\n* CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,\n* OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE\n* OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n*/\n\nimport { uuidv4 } from \"./utils\";\nimport $ from \"jquery\";\n\nexport const pluginName = 'formset';\n\n\nclass Formset {\n    constructor(el, options) {\n        var _this = this;\n\n        //Defaults:\n        this.opts = $.extend({}, Formset.defaults, options);\n\n        this.$formset = $(el);\n        this.$formset.attr(\"data-uuid\", uuidv4());\n        this.$emptyForm = this.$formset.find(this.opts.emptyForm);\n        this.$body = this.$formset.find(this.opts.body);\n        this.$add = this.$formset.find(this.opts.add);\n\n        this.formsetPrefix = $(el).data('formset-prefix');\n\n        // Bind to the `Add form` button\n        this.addForm = $.proxy(this, 'addForm');\n        this.$add.click(this.addForm);\n\n        // Bind receiver to `formAdded` and `formDeleted` events\n        this.$formset.on('formAdded formDeleted', this.opts.form, $.proxy(this, 'checkMaxForms'));\n\n        // Set up the existing forms\n        this.$forms().each(function (i, form) {\n            var $form = $(form);\n            _this.bindForm($(this), i);\n        });\n\n        // Store a reference to this in the formset element\n        this.$formset.data(pluginName, this);\n\n        var extras = ['animateForms'];\n        $.each(extras, function (i, extra) {\n            if ((extra in _this.opts) && (_this.opts[extra])) {\n                _this[extra]();\n            }\n        });\n    }\n    static getOrCreate(el, options) {\n        var rev = $(el).data(pluginName);\n        if (!rev) {\n            rev = new Formset(el, options);\n        }\n\n        return rev;\n    }\n    addForm() {\n        // Don't proceed if the number of maximum forms has been reached\n        if (this.hasMaxForms()) {\n            throw new Error(\"MAX_NUM_FORMS reached\");\n        }\n\n        var newIndex = this.totalFormCount();\n        this.$managementForm('TOTAL_FORMS').val(newIndex + 1);\n\n        var newFormHtml = this.$emptyForm.html()\n            .replace(new RegExp('__prefix__', 'g'), newIndex)\n            .replace(new RegExp('<\\\\\\\\/script>', 'g'), '</script>');\n\n        var $newFormFragment = $($.parseHTML(newFormHtml, this.$body.document, true));\n        this.$body.append($newFormFragment);\n\n        var $newForm = $newFormFragment.filter(this.opts.form);\n        this.bindForm($newForm, newIndex);\n        if (this.opts.newFormCallback) {\n            this.opts.newFormCallback($newForm);\n        }\n        return $newForm;\n    }\n    /**\n    * Attach any events needed to a new form\n    */\n    bindForm($form, index) {\n        var prefix = this.formsetPrefix + '-' + index;\n        $form.data(pluginName + '__formPrefix', prefix);\n\n        var $delete = $form.find('[name=' + prefix + '-DELETE]');\n\n        // Trigger `formAdded` / `formDeleted` events when delete checkbox value changes\n        $delete.change(function (event) {\n            if ($delete.is(':checked')) {\n                $form.attr('data-formset-form-deleted', '');\n                // Remove required property and pattern attribute to allow submit, back it up to data field\n                $form.find(':required').data(pluginName + '-required-field', true).prop('required', false);\n                $form.find('input[pattern]').each(function () {\n                    var pattern = $(this).attr('pattern');\n                    $(this).data(pluginName + '-field-pattern', pattern).removeAttr('pattern');\n                });\n                $form.trigger('formDeleted');\n            } else {\n                $form.removeAttr('data-formset-form-deleted');\n                // Restore required property and pattern attributes from data field\n                $form.find('*').filter(function () {\n                    return $(this).data(pluginName + '-required-field') === true;\n                }).prop('required', true);\n                $form.find('input').each(function () {\n                    var pattern = $(this).data(pluginName + '-field-pattern');\n                    if (pattern) {\n                        $(this).attr('pattern', pattern);\n                    }\n                });\n                $form.trigger('formAdded');\n            }\n        }).trigger('change');\n\n        var $deleteButton = $form.find(this.opts.deleteButton);\n\n        $deleteButton.bind('click', function () {\n            $delete.attr('checked', true).change();\n        });\n    }\n    $forms() {\n        return this.$body.find(this.opts.form);\n    }\n    $managementForm(name) {\n        return this.$formset.find('[name=' + this.formsetPrefix + '-' + name + ']');\n    }\n    totalFormCount() {\n        return this.$forms().length;\n    }\n    deletedFormCount() {\n        return this.$forms().filter('[data-formset-form-deleted]').length;\n    }\n    clear() {\n        this.$forms().each(function (key, row) {\n            $(row).find(':input').not(':button, :submit, :reset, :hidden, :checkbox, :radio').val('');\n        });\n    }\n    deleteAll() {\n        this.$forms().each(function (key, row) {\n            $(row).find('[deletecheckbox]').prop(\"checked\", true).change();\n        });\n    }\n    activeFormCount() {\n        return this.totalFormCount() - this.deletedFormCount();\n    }\n    openRownum() {\n        var rownum = this.$formset.find('tr.row-open').attr('data-rownum');\n        return typeof rownum != undefined ? parseInt(rownum) : 0;\n    }\n    hasMaxForms() {\n        var maxForms = parseInt(this.$managementForm('MAX_NUM_FORMS').val(), 10) || 1000;\n        return this.activeFormCount() >= maxForms;\n    }\n    checkMaxForms() {\n        if (this.hasMaxForms()) {\n            this.$formset.addClass(this.opts.hasMaxFormsClass);\n            this.$add.attr('disabled', 'disabled');\n        } else {\n            this.$formset.removeClass(this.opts.hasMaxFormsClass);\n            this.$add.removeAttr('disabled');\n        }\n    }\n    animateForms() {\n        this.$formset.on('formAdded', this.opts.form, function () {\n            var $form = $(this);\n            $form.slideUp(0);\n            $form.slideDown();\n        }).on('formDeleted', this.opts.form, function () {\n            var $form = $(this);\n            $form.slideUp();\n        });\n        this.$forms().filter('[data-formset-form-deleted]').slideUp(0);\n    }\n}\n\nFormset.defaults = {\n    form: '[data-formset-form]',\n    emptyForm: 'script[type=form-template][data-formset-empty-form]',\n    body: '[data-formset-body]',\n    add: '[data-formset-add]',\n    deleteButton: '[data-formset-delete-button]',\n    hasMaxFormsClass: 'has-max-forms',\n    animateForms: false,\n    newFormCallback: false\n};\n\nexport default Formset;\n","import $ from \"jquery\";\nimport { templatePacks, uuidv4 } from \"./utils\";\n\nconst modalDefault = {\n  placement: \"center\",\n  size: \"md\",\n  templatePack: null,\n  onHide: () => {},\n  onShow: () => {},\n  onToggle: () => {},\n};\n\nclass Modal {\n  constructor(targetEl = null, options = {}) {\n    this._targetEl = targetEl;\n    this._parentEl = targetEl.parentElement;\n    this._options = {\n      ...modalDefault,\n      ...options,\n    };\n    this._isHidden = true;\n    this._bsParent = this._parentEl.closest(\".modal\");\n    this._init();\n    this._addEventListeners();\n  }\n  _init() {\n    this._getPlacementClasses().map((c) => {\n      this._targetEl.classList.add(c);\n    });\n    this._clearSize();\n    this._getSizeClasses().map((c) => {\n      this._targetEl.firstElementChild.classList.add(c);\n    });\n  }\n  _createBackdrop(id) {\n    if (this._isHidden) {\n      const backdropEl = document.createElement(\"div\");\n      backdropEl.setAttribute(\"data-ref-id\", id);\n      backdropEl.setAttribute(\"modal-backdrop\", \"\");\n      backdropEl.classList.add(...this._getClasses(\"backdrop\"));\n      this._parentEl.append(backdropEl);\n      backdropEl.offsetWidth;\n      backdropEl.classList.add(...this._getClasses(\"opacity50\"));\n    }\n  }\n  _destroyBackdropEl() {\n    if (!this._isHidden) {\n      let id = this._targetEl.getAttribute(\"data-ref-id\");\n      document.querySelector(`[modal-backdrop][data-ref-id=\"${id}\"]`).remove();\n    }\n  }\n  _getPlacementClasses() {\n    let that = this;\n    switch (this._options.placement) {\n      // top\n      case \"top-left\":\n        return [\n          that._getClasses(\"justifyStart\", false),\n          that._getClasses(\"itemsStart\", false),\n        ];\n      case \"top-center\":\n        return [\n          that._getClasses(\"justifyCenter\", false),\n          that._getClasses(\"itemsStart\", false),\n        ];\n      case \"top-right\":\n        return [\n          that._getClasses(\"justifyEnd\", false),\n          that._getClasses(\"itemsStart\", false),\n        ];\n\n      // center\n      case \"center-left\":\n        return [\n          that._getClasses(\"justifyStart\", false),\n          that._getClasses(\"itemsCenter\", false),\n        ];\n      case \"center\":\n        return [\n          that._getClasses(\"justifyCenter\", false),\n          that._getClasses(\"itemsCenter\", false),\n        ];\n      case \"center-right\":\n        return [\n          that._getClasses(\"justifyEnd\", false),\n          that._getClasses(\"itemsCenter\", false),\n        ];\n\n      // bottom\n      case \"bottom-left\":\n        return [\n          that._getClasses(\"justifyStart\", false),\n          that._getClasses(\"itemsEnd\", false),\n        ];\n      case \"bottom-center\":\n        return [\n          that._getClasses(\"justifyCenter\", false),\n          that._getClasses(\"itemsEnd\", false),\n        ];\n      case \"bottom-right\":\n        return [\n          that._getClasses(\"justifyEnd\", false),\n          that._getClasses(\"itemsEnd\", false),\n        ];\n\n      default:\n        return [\n          that._getClasses(\"justifyCenter\", false),\n          that._getClasses(\"itemsCenter\", false),\n        ];\n    }\n  }\n  _getSizeClasses() {\n    return templatePacks[this._options.templatePack].sizes[\n      this._options.size\n    ].split(\" \");\n  }\n  _getClasses(name, str = false) {\n    let names = templatePacks[this._options.templatePack].classes[name];\n    return str ? names : names.split(\" \");\n  }\n  _clearSize() {\n    const element = this._targetEl.firstElementChild;\n    const obj = templatePacks[this._options.templatePack].sizes;\n    for (const key in obj) {\n      if (obj.hasOwnProperty(key)) {\n        element.classList.remove(obj[key]);\n      }\n    }\n  }\n  _addEventListeners() {\n    let that = this;\n    this._targetEl.addEventListener(\"keyup\", function (e) {\n      if (e.which === 27) {\n        e.preventDefault();\n        that.hide();\n      }\n    });\n  }\n  toggle() {\n    if (this._isHidden) {\n      this.show();\n    } else {\n      this.hide();\n    }\n\n    // callback function\n    this._options.onToggle(this);\n  }\n  show() {\n    const id = uuidv4();\n    this._targetEl.classList.add(...this._getClasses(\"flex\"));\n    this._targetEl.classList.remove(...this._getClasses(\"hidden\"));\n    this._targetEl.setAttribute(\"aria-modal\", \"true\");\n    this._targetEl.setAttribute(\"role\", \"dialog\");\n    this._targetEl.removeAttribute(\"aria-hidden\");\n    this._targetEl.setAttribute(\"data-ref-id\", id);\n    this._createBackdrop(id);\n    this._isHidden = false;\n\n    document.body.classList.add(\"modal-open\");\n\n    // callback function\n    this._options.onShow(this);\n\n    let firstEl = this._targetEl.querySelector(\n      'select, input:not([type=\"hidden\"]'\n    );\n    if (firstEl) {\n      firstEl.setAttribute(\"tabindex\", \"0\");\n      firstEl.focus();\n    }\n    this._targetEl.offsetWidth;\n    this._targetEl.classList.add(...this._getClasses(\"opacity100\"));\n\n    if (this._bsParent) {\n      $(this._bsParent).off(\"keydown.dismiss.bs.modal\");\n    }\n  }\n  hide() {\n    this._targetEl.classList.add(...this._getClasses(\"hidden\"));\n    this._targetEl.classList.remove(...this._getClasses(\"flex\"));\n    this._targetEl.setAttribute(\"aria-hidden\", \"true\");\n    this._targetEl.removeAttribute(\"aria-modal\");\n    this._targetEl.removeAttribute(\"role\");\n    this._destroyBackdropEl();\n    this._isHidden = true;\n\n    document.body.classList.remove(\"modal-open\");\n\n    // callback function\n    this._options.onHide(this);\n\n    if (this._bsParent) {\n      this._bsParent.focus();\n      $(this._bsParent).on(\"keydown.dismiss.bs.modal\", (e) => {\n        if (e.which === 27) {\n          e.preventDefault();\n          $(this._bsParent).modal(\"hide\");\n        }\n      });\n    }\n  }\n}\n\nexport default Modal;\n","import Modal from \"./modal\";\nimport { gettext } from \"./utils\";\n\nconst modalFormOptions = {\n  parent: null,\n  modalId: null,\n  onKeyUp: function () {},\n  onClose: function () {},\n  onOpen: function () {},\n};\n\nclass ModalForm {\n  constructor(targetEl, options = {}) {\n    this.targetEl = targetEl;\n    this._options = {\n      ...modalFormOptions,\n      ...options,\n    };\n    this.modalId = this._options.modalId;\n    this._modalEl = null;\n    this._modalTitleEl = null;\n    this._modalDeleteBt = null;\n    this.modalInstance = false;\n    this.rownum = null;\n    this._init();\n    this._addEvents();\n  }\n  _init() {\n    this._modalEl = document.getElementById(this.modalId);\n    this._modalTitleEl = this._modalEl.querySelector(\".modal-title\");\n    this._modalDeleteBt = this._modalEl.querySelector(\".formset-delete\");\n    this._createModal();\n  }\n  _addEvents() {\n    let that = this;\n    this._modalEl\n      .querySelectorAll('[data-formset-modal-toggle=\"' + this.modalId + '\"]')\n      .forEach(function (el) {\n        el.addEventListener(\"click\", function () {\n          that.close();\n        });\n      });\n  }\n  hasFieldError(fieldId) {\n    let fieldWrapper = this.targetEl.querySelector(`#div_${fieldId}`);\n    let hasError = false;\n    let errorText = \"\";\n    fieldWrapper\n      .querySelectorAll(\"[id^='error_']\")\n      .forEach(function (el) {\n        hasError = true;\n        errorText = el.innerText;\n      });\n    return { error: hasError, text: errorText };\n  }\n  hasNonFieldError() {\n    return this.targetEl.querySelector(\".non-field-errors\") != null;\n  }\n  errors() {\n    let errors = {};\n    this.targetEl.querySelectorAll(\"[id^='error_']\").forEach(function (el) {\n      let fieldId = el.id.replace(\"error_\", \"\");\n      let fieldName = fieldId.replace(/.*?-.*?-(.*)/, \"$1\");\n      errors[fieldName] = {\n        error: el.innerText,\n        sourceId: fieldId,\n      };\n    });\n    return errors;\n  }\n  hasErrorsNotIncluded(errors, row) {\n    let errorProps = Object.keys(errors);\n    let propsNotIncluded = errorProps.filter(\n      (prop) => !row.hasOwnProperty(prop)\n    );\n    let allHasErrorFalse = Object.values(row).every(\n      (field) => !field.hasError || !field.hasError.error\n    );\n    return propsNotIncluded.length > 0 && allHasErrorFalse;\n  }\n  _hiddeDefaultDeleteBt(el) {\n    let parentEl = el.parentNode;\n    parentEl.classList.add(\"d-none\");\n  }\n  _createModal() {\n    let that = this;\n    if (!this.modalInstance) {\n      let deleteBt = this.targetEl.querySelector(\".formset-delete\");\n      let modal = new Modal(this._modalEl, {\n        placement: that._options.placement,\n        size: that._options.size,\n        templatePack: that._options.templatePack,\n        onHide: function (modal) {\n          that._onModalClose(modal);\n        },\n        onShow: function (modal) {\n          that._onModalShow(modal);\n        },\n      });\n      modal._targetEl.addEventListener(\"keyup\", function (e) {\n        that._options.onKeyUp(e, that);\n      });\n      this.modalInstance = modal;\n      this._hiddeDefaultDeleteBt(deleteBt);\n    }\n  }\n  _onModalShow(modal) {\n    this._options.onOpen(this);\n    let openRowBt = this._options.parent.targetEl.querySelector(\n      \".btn-open-row[data-formset-modal-toggle='\" + this.modalId + \"']\"\n    );\n    let tr = openRowBt.closest(\"tr\");\n    this._modalTitleEl.innerText = gettext(\"Editing row #\") + this.rownum;\n    tr.classList.add(\"row-open\");\n  }\n  _onModalClose(modal) {\n    this._options.onClose(this);\n    let openRowBt = this._options.parent.targetEl.querySelector(\n      \".btn-open-row[data-formset-modal-toggle='\" + this.modalId + \"']\"\n    );\n    if (openRowBt) {\n      let tr = openRowBt.closest(\"tr\");\n      tr.classList.remove(\"row-open\");\n    }\n  }\n  isDeleted() {\n    return this.targetEl.hasAttribute(\"data-formset-form-deleted\");\n  }\n  isSelected() {\n    return this.targetEl.hasAttribute(\"data-formset-form-selected\");\n  }\n  open() {\n    this.modalInstance.show();\n  }\n  close() {\n    this.modalInstance.hide();\n  }\n}\n\nexport default ModalForm;\n","import $ from \"jquery\";\nimport ModalForm from \"./modal-form\";\nimport {\n  executeAllCalculatedFields,\n  getNumberValue,\n  getTextValue,\n  hookCalculatedFields,\n  removeChildren,\n  templatePacks,\n  uuidv4,\n} from \"./utils\";\n\nconst variant = {\n  tabular: \"tabular\",\n  stacked: \"stacked\",\n  modal: \"modal\",\n};\n\nclass FormsetModal {\n  constructor(elementId) {\n    this._id = elementId;\n    this.targetEl = document.getElementById(this._id);\n    this.variant = variant.tabular;\n    this.$formset = null;\n    this._modalForms = [];\n    this._deleteBt = null;\n    this._table = null;\n    this._tbody = null;\n    this._tfoot = null;\n    this._init();\n    this._addEvents();\n  }\n  _init() {\n    this.variant = this._getVariant();\n    this.templatePack = this._getTemplatePack();\n    this.modalSize = this._getModalSize();\n    this.modalPlacement = this._getModalPlacement();\n    // Create Formset Helper Instance\n    this.$formset = $(`#${this._id}`);\n    this.$formset.formset({\n      animateForms: true,\n    });\n    if (this.variant === variant.modal || this.variant == variant.tabular) {\n      this._table = this.targetEl.querySelector(\"table\");\n      this._tbody = this._table.querySelector(\"tbody\");\n      this._tfoot = this._table.querySelector(\"tfoot\");\n      this._emptyState = this._tbody.innerHTML;\n    }\n    if (this.variant === variant.modal) {\n      this._deleteBt = this.targetEl.querySelector(\".delete-selected\");\n      this._checkInitials();\n      this._configureSelectAllToggler();\n      this._refresh();\n    }\n    this.targetEl.setAttribute(\"data-formset-initialized\", \"true\");\n  }\n  _getVariant() {\n    return this.targetEl.getAttribute(\"data-formset-variant\");\n  }\n  _getTemplatePack() {\n    return this.targetEl.getAttribute(\"data-template-pack\");\n  }\n  _getClasses(name) {\n    return templatePacks[this.templatePack].classes[name].split(\" \");\n  }\n  _getEditButton(modalId) {\n    const templateEl = this.targetEl.querySelector(\"template\");\n    const template = templateEl.content.cloneNode(true);\n    const editButton = template.querySelector(\"button\");\n\n    if (!editButton.classList.contains(\"btn-open-row\")) {\n      editButton.classList.add(\"btn-open-row\");\n    }\n\n    editButton.setAttribute(\"data-formset-modal-toggle\", modalId);\n    return editButton;\n  }\n  _getModalSize() {\n    return this.targetEl.getAttribute(\"data-modal-size\");\n  }\n  _getModalPlacement() {\n    return this.targetEl.getAttribute(\"data-modal-placement\");\n  }\n  _getModalFormInstanceByRownum(rownum) {\n    let instance = false;\n    this._modalForms.forEach(function (obj) {\n      if (obj.rownum === rownum && !obj.isDeleted()) {\n        instance = obj;\n      }\n    });\n    return instance;\n  }\n  _addEvents() {\n    let that = this;\n    this.$formset.on(\"formAdded\", function (e) {\n      that._onFormsetAdded(e);\n      window.crispyFormsetModal.onFormAdded(e);\n    });\n    this.$formset.on(\"formDeleted\", function (e) {\n      that._onFormsetDeleted(e);\n      window.crispyFormsetModal.onFormDeleted(e);\n    });\n    this.targetEl.addEventListener(\"click\", function (e) {\n      if (e.target.closest(\"[data-formset-previous-button]\")) {\n        e.preventDefault();\n        that._navigateToPrevious();\n      }\n      if (e.target.closest(\"[data-formset-next-button]\")) {\n        e.preventDefault();\n        that._navigateToNext();\n      }\n    });\n  }\n  _navigateToPrevious() {\n    let currentModalForm = this._getCurrentOpenModalForm();\n    if (currentModalForm) {\n      this._navigateUp(currentModalForm);\n    }\n  }\n  _navigateToNext() {\n    let currentModalForm = this._getCurrentOpenModalForm();\n    if (currentModalForm) {\n      this._navigateDown(currentModalForm);\n    }\n  }\n  _navigateUp(modalForm) {\n    let openRownum = modalForm.rownum;\n    if (openRownum > 1) {\n      modalForm.close();\n      let previousModalForm = this._getModalFormInstanceByRownum(openRownum - 1);\n      previousModalForm.open();\n    }\n  }\n  _navigateDown(modalForm) {\n    let openRownum = modalForm.rownum;\n    let $formset = this.$formset.formset(\"getOrCreate\");\n    let activeFormCount = $formset.activeFormCount();\n    \n    if (openRownum < activeFormCount) {\n      modalForm.close();\n      let nextModalForm = this._getModalFormInstanceByRownum(openRownum + 1);\n      nextModalForm.open();\n    } else if (openRownum == activeFormCount) {\n      modalForm.close();\n      $formset.addForm();\n    }\n  }\n  _getCurrentOpenModalForm() {\n    return this._modalForms.find(modalForm => \n      !modalForm.isDeleted() && !modalForm.modalInstance._isHidden\n    );\n  }\n  _updateNavigationButtons(modalForm) {\n    let $formset = this.$formset.formset(\"getOrCreate\");\n    let activeFormCount = $formset.activeFormCount();\n    let currentRownum = modalForm.rownum;\n    \n    let previousButton = modalForm._modalEl.querySelector('[data-formset-previous-button]');\n    let nextButton = modalForm._modalEl.querySelector('[data-formset-next-button]');\n    let plusIcon = modalForm._modalEl.querySelector('[data-plus-icon]');\n    let nextIcon = modalForm._modalEl.querySelector('[data-next-icon]');\n    \n    if (previousButton) {\n      if (currentRownum <= 1) {\n        previousButton.disabled = true;\n        previousButton.classList.add('disabled');\n      } else {\n        previousButton.disabled = false;\n        previousButton.classList.remove('disabled');\n      }\n    }\n    \n    if (nextButton && currentRownum >= activeFormCount) {\n      if (plusIcon && nextIcon) {\n        nextIcon.style.display = 'none';\n        plusIcon.style.display = 'inline';\n      }\n    } else {\n      if (plusIcon && nextIcon) {\n        nextIcon.style.display = 'inline';\n        plusIcon.style.display = 'none';\n      }\n    }\n  }\n  /**\n   * Check if the page loaded form from the server to configure them.\n   */\n  _checkInitials() {\n    let that = this;\n    let modals = [];\n    this.targetEl\n      .querySelectorAll(\"[data-formset-modal-toggle]\")\n      .forEach(function (el) {\n        let targetEl = el.closest(\"[data-formset-form]\");\n        let modalId = el.getAttribute(\"data-formset-modal-toggle\");\n        if (!modals.includes(modalId)) {\n          that._newModalForm(targetEl, modalId);\n        }\n        modals.push(modalId);\n      });\n  }\n  _newModalForm(targetEl, modalId) {\n    let that = this;\n    let options = {\n      parent: that,\n      modalId: modalId,\n      size: that.modalSize,\n      placement: that.modalPlacement,\n      templatePack: that.templatePack,\n      onKeyUp: function (e, modalForm) {\n        that._onModalFormKeyUp(e, modalForm);\n      },\n      onOpen: function (modalForm) {\n        that._onModalFormOpen(modalForm);\n      },\n      onClose: function (modalForm) {\n        that._onModalFormClose(modalForm);\n      },\n    };\n    let modalForm = new ModalForm(targetEl, options);\n    that._modalForms.push(modalForm);\n    return modalForm;\n  }\n  _onFormsetAdded(e) {\n    if (this.variant === variant.modal) {\n      let id = uuidv4();\n      $(this.targetEl).find(\"#__dialog_id__\").attr(\"id\", id);\n      $(this.targetEl)\n        .find('[data-formset-modal-toggle=\"__dialog_id__\"]')\n        .attr(\"data-formset-modal-toggle\", id);\n      let modalForm = this._newModalForm(e.target, id);\n      modalForm.open();\n    }\n    if (window.hasOwnProperty(\"calculatedFields\")) {\n      window.resetCalculatedFields();\n      hookCalculatedFields();\n    }\n  }\n  _onFormsetDeleted() {\n    if (this.variant == variant.modal) {\n      this._refresh();\n    }\n    executeAllCalculatedFields();\n  }\n  _onModalFormKeyUp(e, modalForm) {\n    if (e.ctrlKey && (e.keyCode === 38 || e.keyCode === 40)) {\n      e.preventDefault();\n      if (e.keyCode == 38) {\n        // Up\n        this._navigateUp(modalForm);\n      }\n      if (e.keyCode === 40) {\n        // Down\n        this._navigateDown(modalForm);\n      }\n    }\n  }\n  _onModalFormOpen(modalForm) {\n    this._refresh();\n    window.crispyFormsetModal.onModalFormOpened(modalForm);\n    this._updateNavigationButtons(modalForm);\n  }\n  _onModalFormClose(modalForm) {\n    this._refresh();\n    window.crispyFormsetModal.onModalFormClosed(modalForm);\n  }\n  _configureSelectAllToggler() {\n    let that = this;\n    let table = this._table;\n    let toggler = this.targetEl.querySelector(\".select-all\");\n    let deleteBt = this.targetEl.querySelector(\".delete-selected\");\n\n    toggler.addEventListener(\"change\", function (e) {\n      let checked = toggler.checked;\n      let checkBoxes = table.querySelectorAll(\".select-row\");\n      checkBoxes.forEach(function (checkbox) {\n        let tr = checkbox.closest(\"tr\");\n        let td = checkbox.closest(\"td\");\n        let btnOpenRow = tr.querySelector(\"[data-formset-modal-toggle]\");\n        let modalId = btnOpenRow.getAttribute(\"data-formset-modal-toggle\");\n        let modalEl = document.getElementById(modalId);\n        let formsetFormEl = modalEl.closest(\"[data-formset-form]\");\n        checkbox.checked = checked;\n        that._checker(tr, td, formsetFormEl, checkbox);\n      });\n    });\n\n    deleteBt.addEventListener(\"click\", function (e) {\n      let formset = that.targetEl;\n      let selectedForms = formset.querySelectorAll(\n        \"[data-formset-form-selected]:not([data-formset-form-deleted])\"\n      );\n      selectedForms.forEach(function (selectedForm) {\n        let deleteCheckbox = selectedForm.querySelector(\".formset-delete\");\n        deleteCheckbox.checked = true;\n        deleteCheckbox.dispatchEvent(new Event(\"change\"));\n      });\n    });\n  }\n  _checkSelectAllState() {\n    let table = this._table;\n    let formset = this.targetEl;\n    let deleteBt = formset.querySelector(\".delete-selected\");\n    let showDeleteBt = false;\n    let selectAllToggler = table.querySelector(\".select-all\");\n    let recordCount = table.querySelectorAll(\"tbody tr\").length;\n    let selected = table.querySelectorAll(\"tr.selected\").length;\n\n    if (selected === recordCount && recordCount > 0) {\n      selectAllToggler.checked = true;\n      selectAllToggler.indeterminate = false;\n      showDeleteBt = true;\n    } else {\n      if (selected != recordCount && selected > 0) {\n        selectAllToggler.indeterminate = true;\n        selectAllToggler.checked = false;\n        showDeleteBt = true;\n      }\n      if (selected === 0) {\n        selectAllToggler.checked = false;\n        selectAllToggler.indeterminate = false;\n        showDeleteBt = false;\n      }\n    }\n\n    if (showDeleteBt) {\n      deleteBt.classList.remove(...this._getClasses(\"hidden\"));\n      deleteBt.classList.add(...this._getClasses(\"inlineFlex\"));\n    } else {\n      deleteBt.classList.remove(...this._getClasses(\"inlineFlex\"));\n      deleteBt.classList.add(...this._getClasses(\"hidden\"));\n    }\n  }\n  _checker(tr, td, formsetFormEl, checkbox) {\n    // remove previous divSel if exists.\n    let prevDivSel = td.querySelector(\n      \".cfm-selection-border, .selection-border\"\n    );\n    if (prevDivSel) {\n      prevDivSel.remove();\n    }\n    if (checkbox.checked) {\n      let divSel = document.createElement(\"div\");\n      td.classList.add(...this._getClasses(\"relative\"));\n      divSel.classList.add(...this._getClasses(\"selectionMark\"));\n      td.prepend(divSel);\n      formsetFormEl.setAttribute(\"data-formset-form-selected\", \"selected\");\n      tr.classList.add(\"selected\");\n    } else {\n      checkbox.classList.remove(...this._getClasses(\"relative\"));\n      tr.classList.remove(\"selected\");\n      formsetFormEl.removeAttribute(\"data-formset-form-selected\");\n    }\n    this._checkSelectAllState();\n  }\n  _refresh() {\n    let that = this;\n    let fields = {};\n    let fieldNames = [];\n    let rows = [];\n\n    this._table.querySelectorAll(\"[data-field-name]\").forEach(function (el) {\n      fields[el.getAttribute(\"data-field-name\")] = {\n        type: el.getAttribute(\"data-field-type\"),\n        hasSummary: el.hasAttribute(\"data-field-summary\"),\n        summary: 0,\n      };\n    });\n\n    fieldNames = Object.keys(fields);\n\n    this._modalForms.forEach(function (modalForm) {\n      if (!modalForm.isDeleted()) {\n        let row = {};\n        modalForm.targetEl\n          .querySelectorAll(\"input, select, textarea\")\n          .forEach(function (el) {\n            let match = el.name.match(\n              /(?<form>\\w+)-(?<number>\\w+)-(?<name>\\w+)/\n            );\n            if (match) {\n              let name = match.groups.name;\n              if (fieldNames.includes(name)) {\n                let content = getTextValue(el);\n                row[name] = {\n                  value: content,\n                  sourceId: el.getAttribute(\"id\"),\n                  hasError: modalForm.hasFieldError(el.getAttribute(\"id\")),\n                };\n                row[\"modalForm\"] = modalForm;\n              }\n            }\n          });\n        rows.push(row);\n      }\n    });\n\n    // Remove all rows\n    removeChildren(this._tbody);\n\n    if (rows.length === 0) {\n      this._tbody.innerHTML = this._emptyState;\n    }\n\n    let rownum = 1;\n    rows.forEach(function (row) {\n      row.modalForm.rownum = rownum;\n      // Table row\n      let tr = document.createElement(\"tr\");\n      tr.classList.add(...that._getClasses(\"tr\"));\n      tr.setAttribute(\"data-rownum\", rownum);\n      // Highlight row if there are non field errors\n      if (\n        row.modalForm.hasNonFieldError() ||\n        row.modalForm.hasErrorsNotIncluded(row.modalForm.errors(), row)\n      ) {\n        tr[\"style\"] = \"border: 2px solid #ff4545\";\n      }\n      // Selection column\n      let tdSel = document.createElement(\"td\");\n      tdSel.style.textAlign = \"center\";\n      let selCheckbox = document.createElement(\"input\");\n      selCheckbox.setAttribute(\"type\", \"checkbox\");\n      selCheckbox.classList.add(...that._getClasses(\"checkbox\"));\n      selCheckbox.classList.add(\"select-row\");\n      tdSel.appendChild(selCheckbox);\n      tdSel.classList.add(...that._getClasses(\"td\"));\n      selCheckbox.addEventListener(\"change\", function (e) {\n        that._checker(tr, tdSel, row.modalForm.targetEl, e.target);\n      });\n      tr.appendChild(tdSel);\n      // Column for row number\n      let tdNumber = document.createElement(\"td\");\n      tdNumber.classList.add(...that._getClasses(\"td\"));\n      tdNumber.classList.add(...that._getClasses(\"textRight\"));\n      tdNumber.classList.add(...that._getClasses(\"pointer\"));\n      tdNumber.innerText = rownum;\n      tdNumber.addEventListener(\"click\", function () {\n        row.modalForm.open();\n      });\n      tr.appendChild(tdNumber);\n      // Mirror columns\n      fieldNames.forEach(function (field) {\n        let td = document.createElement(\"td\");\n        let hasError = row[field].hasError;\n        td.classList.add(...that._getClasses(\"td\"));\n        if (hasError.error) {\n          td[\"style\"] = \"border: 2px solid #ff4545\";\n          td[\"title\"] = hasError.text;\n        }\n        if (fields[field].type === \"bool\") {\n          let checked = row[field].value === \"on\" ? \"checked\" : \"\";\n          td.innerHTML = `<input type=\"checkbox\" class=\"${that\n            ._getClasses(\"checkbox\")\n            .join(\" \")}\" ${checked} disabled></input>`;\n        } else {\n          td.innerText = row[field].value;\n        }\n        if (fields[field].type === \"numeric\") {\n          td.classList.add(...that._getClasses(\"textRight\"));\n          if (fields[field].hasSummary) {\n            fields[field].summary =\n              fields[field].summary + getNumberValue(row[field].value);\n          }\n        }\n        if (fields[field].type === \"bool\" || fields[field].type == \"date\") {\n          td.classList.add(...that._getClasses(\"textCenter\"));\n        }\n        td.setAttribute(\"data-source\", row[field].sourceId);\n        tr.appendChild(td);\n      });\n      // Column for edit button\n      let tdEdit = document.createElement(\"td\");\n      tdEdit.classList.add(...that._getClasses(\"td\"));\n      tdEdit.classList.add(...that._getClasses(\"textCenter\"));\n      tdEdit.classList.add(...that._getClasses(\"p0\"));\n      tdEdit.classList.add(...that._getClasses(\"alignMiddle\"));\n      tdEdit.appendChild(that._getEditButton(row.modalForm.modalId));\n      let button = tdEdit.querySelector(\".btn-open-row\");\n\n      button.addEventListener(\"click\", function (e) {\n        row.modalForm.open();\n      });\n\n      tr.appendChild(tdEdit);\n      that._tbody.appendChild(tr);\n\n      if (row.modalForm.isSelected()) {\n        selCheckbox.checked = true;\n        that._checker(tr, tdSel, row.modalForm.targetEl, selCheckbox);\n      }\n\n      rownum++;\n    });\n\n    if (this._tfoot) {\n      this._tfoot\n        .querySelectorAll(\"[data-summary-column]\")\n        .forEach(function (el) {\n          let summary = fields[el.getAttribute(\"data-summary-column\")].summary;\n          el.innerText = summary;\n        });\n    }\n\n    this._checkSelectAllState();\n  }\n}\n\nexport default FormsetModal;\n","import $ from \"jquery\";\nimport Formset, { pluginName } from \"./formset\";\nimport FormsetModal from \"./formset-modal\";\nimport Modal from \"./modal\";\nimport {\n  executeAllCalculatedFields,\n  getModalInstance,\n  hookCalculatedFields,\n  ready,\n  injectStyles,\n} from \"./utils\";\n\nwindow.crispyFormsetModal = {};\n\nfunction configureFormsets() {\n  let formsets = document.querySelectorAll(\".formset\");\n  formsets.forEach(function (formsetEl) {\n    if (!formsetEl.hasAttribute(\"data-formset-initialized\")) {\n      new FormsetModal(formsetEl.getAttribute(\"id\"));\n    }\n  });\n}\n\nfunction configureModals() {\n  let modalInstances = [];\n  document.querySelectorAll(\"[data-modal-toggle]\").forEach((el) => {\n    const modalId = el.getAttribute(\"data-modal-toggle\");\n    const modalEl = document.getElementById(modalId);\n    const placement = modalEl.getAttribute(\"data-modal-placement\");\n\n    if (modalEl) {\n      if (\n        !modalEl.hasAttribute(\"aria-hidden\") &&\n        !modalEl.hasAttribute(\"aria-modal\")\n      ) {\n        modalEl.setAttribute(\"aria-hidden\", \"true\");\n      }\n    }\n\n    let modal = null;\n    if (getModalInstance(modalId, modalInstances)) {\n      modal = getModalInstance(modalId, modalInstances);\n      modal = modal.object;\n    } else {\n      modal = new Modal(modalEl, {\n        placement: placement ? placement : Default.placement,\n      });\n      modalInstances.push({\n        id: modalId,\n        object: modal,\n      });\n    }\n\n    if (\n      modalEl.hasAttribute(\"data-modal-show\") &&\n      modalEl.getAttribute(\"data-modal-show\") === \"true\"\n    ) {\n      modal.show();\n    }\n\n    el.addEventListener(\"click\", () => {\n      modal.toggle();\n    });\n  });\n}\n\n$.fn[pluginName] = function () {\n  var options, fn, args;\n  // Create a new Formset for each element\n  if (\n    arguments.length === 0 ||\n    (arguments.length === 1 && $.type(arguments[0]) != \"string\")\n  ) {\n    options = arguments[0];\n    return this.each(function () {\n      return Formset.getOrCreate(this, options);\n    });\n  }\n\n  // Call a function on each Formset in the selector\n  fn = arguments[0];\n  args = $.makeArray(arguments).slice(1);\n\n  if (fn in Formset) {\n    // Call the Formset class method if it exists\n    args.unshift(this);\n    return Formset[fn].apply(Formset, args);\n  } else {\n    throw new Error(\"Unknown function call \" + fn + \" for $.fn.formset\");\n  }\n};\n\nwindow.crispyFormsetModal.init = function () {\n  injectStyles();\n  configureFormsets();\n  configureModals();\n  hookCalculatedFields();\n  executeAllCalculatedFields();\n}\n\nwindow.crispyFormsetModal.refresh = function () {\n  configureFormsets();\n  configureModals();\n  hookCalculatedFields();\n  executeAllCalculatedFields();\n};\n\nwindow.crispyFormsetModal.onFormAdded = function () {};\nwindow.crispyFormsetModal.onFormDeleted = function () {};\nwindow.crispyFormsetModal.onModalFormOpened = function () {};\nwindow.crispyFormsetModal.onModalFormClosed = function () {};\n\nready(function () {\n  window.crispyFormsetModal.init();\n});\n"],"names":["gettext","window","_has","Object","prototype","hasOwnProperty","uuidv4","randomHex","Math","floor","random","toString","substring","parseInt","getTextValue","el","textValue","tagName","toLowerCase","tempDiv","document","createElement","options","selectedIndex","innerHTML","innerText","split","map","item","trim","join","object","key","call","inputmask","undoValue","getAttribute","value","checked","executeAllCalculatedFields","calculatedFields","forEach","obj","executeAll","hookCalculatedFields","field","id","querySelector","hasAttribute","addEventListener","content","_column","setAttribute","getModalInstance","instances","some","modalInstance","find","django","jsi18n_initialized","msg","bootstrap4Classes","hidden","inlineFlex","flex","relative","textRight","textCenter","alignMiddle","pointer","checkbox","td","tr","selectionMark","p0","opacity50","opacity100","backdrop","justifyStart","justifyCenter","justifyEnd","itemsStart","itemsCenter","itemsEnd","bootstrap4SizeClasses","sm","md","lg","xl","templatePacks","bootstrap4","classes","sizes","bootstrap5","tailwind","bulma","pluginName","Formset","constructor","_this","this","opts","$","extend","defaults","$formset","attr","$emptyForm","emptyForm","$body","body","$add","add","formsetPrefix","data","addForm","proxy","click","on","form","$forms","each","i","bindForm","extra","static","rev","hasMaxForms","Error","newIndex","totalFormCount","$managementForm","val","newFormHtml","html","replace","RegExp","$newFormFragment","parseHTML","append","$newForm","filter","newFormCallback","$form","index","prefix","$delete","change","event","is","prop","pattern","removeAttr","trigger","deleteButton","bind","name","length","deletedFormCount","clear","row","not","deleteAll","activeFormCount","openRownum","rownum","maxForms","checkMaxForms","addClass","hasMaxFormsClass","removeClass","animateForms","slideUp","slideDown","modalDefault","placement","size","templatePack","onHide","onShow","onToggle","Modal","targetEl","_targetEl","_parentEl","parentElement","_options","_isHidden","_bsParent","closest","_init","_addEventListeners","_getPlacementClasses","c","classList","_clearSize","_getSizeClasses","firstElementChild","_createBackdrop","backdropEl","_getClasses","offsetWidth","_destroyBackdropEl","remove","that","str","names","element","e","which","preventDefault","hide","toggle","show","removeAttribute","firstEl","focus","off","modal","modalFormOptions","parent","modalId","onKeyUp","onClose","onOpen","ModalForm","_modalEl","_modalTitleEl","_modalDeleteBt","_addEvents","getElementById","_createModal","querySelectorAll","close","hasFieldError","fieldId","fieldWrapper","hasError","errorText","error","text","hasNonFieldError","errors","fieldName","sourceId","hasErrorsNotIncluded","propsNotIncluded","keys","allHasErrorFalse","values","every","_hiddeDefaultDeleteBt","parentNode","deleteBt","_onModalClose","_onModalShow","openRowBt","isDeleted","isSelected","open","variant","FormsetModal","elementId","_id","_modalForms","_deleteBt","_table","_tbody","_tfoot","_getVariant","_getTemplatePack","modalSize","_getModalSize","modalPlacement","_getModalPlacement","formset","_emptyState","_checkInitials","_configureSelectAllToggler","_refresh","_getEditButton","editButton","cloneNode","contains","_getModalFormInstanceByRownum","instance","_onFormsetAdded","crispyFormsetModal","onFormAdded","_onFormsetDeleted","onFormDeleted","target","_navigateToPrevious","_navigateToNext","currentModalForm","_getCurrentOpenModalForm","_navigateUp","_navigateDown","modalForm","_updateNavigationButtons","currentRownum","previousButton","nextButton","plusIcon","nextIcon","disabled","style","display","modals","includes","_newModalForm","push","_onModalFormKeyUp","_onModalFormOpen","_onModalFormClose","resetCalculatedFields","ctrlKey","keyCode","onModalFormOpened","onModalFormClosed","table","toggler","formsetFormEl","_checker","selectedForm","deleteCheckbox","dispatchEvent","Event","_checkSelectAllState","showDeleteBt","selectAllToggler","recordCount","selected","indeterminate","prevDivSel","divSel","prepend","fields","fieldNames","rows","type","hasSummary","summary","match","groups","a","hasChildNodes","removeChild","lastChild","removeChildren","tdSel","textAlign","selCheckbox","appendChild","tdNumber","Number","tdEdit","configureFormsets","formsetEl","configureModals","modalInstances","modalEl","Default","fn","args","arguments","getOrCreate","makeArray","slice","unshift","apply","init","styleId","css","head","refresh","readyState"],"mappings":"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"}